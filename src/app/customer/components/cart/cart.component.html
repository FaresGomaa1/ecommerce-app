<main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 cart-container">
  <h2 class="cart-title mb-4 text-center">Your Shopping Cart</h2>

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-5">
    <i class="fas fa-spinner fa-spin fa-3x"></i>
    <p>Loading your cart items...</p>
  </div>

  <!-- Cart Table -->
  <div *ngIf="!loading && cartItems.length > 0" class="cart-content">
    <table class="table table-hover table-bordered align-middle">
      <thead class="bg-light text-center">
        <tr>
          <th>Product</th>
          <th>Color</th>
          <th>Size</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of cartItems" class="text-center">
          <td class="product-info">
            <!-- <img [src]="item.imageUrl" alt="{{ item.productName }}" class="product-thumbnail me-2"> -->
            <span>{{ item.productName }}</span>
          </td>
          <td>{{ item.color }}</td>
          <td>{{ item.size }}</td>
          <td>{{ item.productPrice | currency : "EGP" }}</td>
          <td>
            <input
              type="number"
              class="form-control quantity-input"
              [(ngModel)]="item.quantity"
              min="1"
              (change)="onQuantityChange(item)"
            />
          </td>
          <td>{{ item.productPrice * item.quantity | currency : "EGP" }}</td>
          <td>
            <button
              class="btn btn-danger btn-sm"
              data-bs-toggle="modal"
              [attr.data-bs-target]="'#removeModal' + item.id"
            >
              <i class="fas fa-trash-alt"></i> Remove
            </button>

            <!-- Remove Confirmation Modal -->
            <div
              class="modal fade"
              [attr.id]="'removeModal' + item.id"
              tabindex="-1"
              [attr.aria-labelledby]="'removeModalLabel' + item.id"
              aria-hidden="true"
            >
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5
                      class="modal-title"
                      [attr.id]="'removeModalLabel' + item.id"
                    >
                      Confirm Removal
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    Are you sure you want to remove
                    <strong>{{ item.productName }}</strong> from your cart?
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-danger"
                      (click)="remove(item.id)"
                      data-bs-dismiss="modal"
                    >
                      Remove
                    </button>
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <button
              class="btn btn-link btn-sm view-details"
              (click)="view(item.productId)"
            >
              <i class="fas fa-info-circle"></i> View Details
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Cart Summary -->
    <div class="cart-summary mt-5 p-4">
      <div class="d-flex justify-content-between">
        <span class="fw-bold">Subtotal:</span>
        <span>{{ total | currency : "EGP" }}</span>
      </div>
      <div class="text-center mt-4">
        <a href="/checkout" class="btn btn-primary btn-lg w-100"
          >Proceed to Checkout</a
        >
      </div>
    </div>
  </div>

  <!-- Empty Cart State -->
  <div
    *ngIf="!loading && cartItems.length === 0"
    class="text-center empty-cart"
  >
    <i class="fas fa-shopping-cart fa-4x mb-3"></i>
    <p>Your cart is empty!</p>
    <a href="/shop" class="btn btn-outline-primary">Start Shopping</a>
  </div>
</main>
